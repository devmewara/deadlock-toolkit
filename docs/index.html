<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deadlock Prevention & Recovery Toolkit</title>

    <link rel="stylesheet" href="style.css">

    <!-- Vis.js (for RAG) -->
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <div class="container">

        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <h2>Deadlock Toolkit</h2>
            </div>

            <ul class="menu">
                <li class="menu-item active" data-target="home">üè† Home</li>
                <li class="menu-item" data-target="rag">üï∏Ô∏è RAG Visualization</li>
                <li class="menu-item" data-target="banker">üè¶ Banker's Algorithm</li>
                <li class="menu-item" data-target="detection">üîç Detection & Recovery</li>
                <li class="menu-item" data-target="scenarios">üé¨ Scenarios</li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="content">

            <!-- HOME -->
            <section id="home" class="active-section">
                <header class="header">
                    <h1>Welcome to Deadlock Toolkit</h1>
                    <p>Explore deadlock concepts, prevention mechanisms, detection & recovery.</p>
                </header>

                <div class="cards-grid">
                    <div class="card" onclick="openSection('rag')">
                        <h3>Resource Allocation Graph</h3>
                        <p>Visualize processes and resources.</p>
                    </div>
                    <div class="card" onclick="openSection('banker')">
                        <h3>Banker's Algorithm</h3>
                        <p>Check safety & generate safe sequence.</p>
                    </div>
                    <div class="card" onclick="openSection('detection')">
                        <h3>Detection & Recovery</h3>
                        <p>Detect deadlocks and recover.</p>
                    </div>
                    <div class="card" onclick="openSection('scenarios')">
                        <h3>Classic Scenarios</h3>
                        <p>Dining Philosophers, Traffic Deadlock, etc.</p>
                    </div>
                </div>
            </section>

            <!-- RAG SECTION -->
            <section id="rag">
                <header class="header">
                    <h1>Resource Allocation Graph</h1>
                    <p>Create processes, resources & detect cycles.</p>
                </header>

                <div class="controls">
                    <button id="rag-add-process" class="btn primary">Add Process</button>
                    <button id="rag-add-resource" class="btn primary">Add Resource</button>
                    <button id="rag-reset" class="btn warning">Reset</button>
                    <button id="rag-check" class="btn success">Check Deadlock</button>
                </div>

                <div class="rag-container">
                    <div id="rag-network"></div>
                    <div id="rag-status" class="status-panel">
                        <h3>Status</h3>
                        <p id="rag-message">Ready to build graph...</p>
                    </div>
                </div>
            </section>

            <!-- BANKER SECTION -->
            <section id="banker">
                <header class="header">
                    <h1>Banker's Algorithm</h1>
                </header>

                <div class="input-group">
                    <label>Processes: <input type="number" id="banker-processes" value="5" min="1"></label>
                    <label>Resources: <input type="number" id="banker-resources" value="3" min="1"></label>
                    <button id="banker-generate" class="btn primary">Generate Tables</button>
                </div>

                <div id="banker-tables" class="tables-container" style="display:none;">
                    <div class="table-wrapper">
                        <h3>Allocation</h3>
                        <table id="banker-allocation"></table>
                    </div>
                    <div class="table-wrapper">
                        <h3>Max</h3>
                        <table id="banker-max"></table>
                    </div>
                    <div class="table-wrapper">
                        <h3>Need</h3>
                        <table id="banker-need"></table>
                    </div>
                    <div class="table-wrapper">
                        <h3>Available</h3>
                        <table id="banker-available"></table>
                    </div>
                </div>

                <div id="banker-actions" class="actions" style="display:none;">
                    <button id="banker-check" class="btn success">Check Safe State</button>
                </div>

                <div id="banker-output" class="output-panel"></div>
            </section>

            <!-- DETECTION SECTION -->
            <section id="detection">
                <header class="header">
                    <h1>Deadlock Detection & Recovery</h1>
                </header>

                <div class="input-group">
                    <label>Processes: <input type="number" id="detect-processes" value="5" min="1"></label>
                    <label>Resources: <input type="number" id="detect-resources" value="3" min="1"></label>
                    <button id="detect-generate" class="btn primary">Generate Tables</button>
                </div>

                <div id="detect-tables" class="tables-container" style="display:none;">
                    <div class="table-wrapper">
                        <h3>Allocation</h3>
                        <table id="detect-allocation"></table>
                    </div>
                    <div class="table-wrapper">
                        <h3>Request</h3>
                        <table id="detect-request"></table>
                    </div>
                    <div class="table-wrapper">
                        <h3>Available</h3>
                        <table id="detect-available"></table>
                    </div>
                </div>

                <div id="detect-actions" class="actions" style="display:none;">
                    <button id="detect-check" class="btn success">Detect Deadlock</button>
                </div>

                <div id="detect-output" class="output-panel"></div>
            </section>

            <!-- SCENARIOS SECTION -->
            <section id="scenarios">
                <header class="header">
                    <h1>Classic Deadlock Scenarios</h1>
                    <p>Explore real-world deadlock problems and practical examples.</p>
                </header>

                <div class="scenario-cards">

                    <!-- Dining Philosophers -->
                    <div class="scenario-card">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/5/5f/Dining_philosophers.png"
                            class="scenario-img">
                        <h3>üçΩÔ∏è Dining Philosophers</h3>
                        <p><b>Scenario:</b> Five philosophers sit around a table with five chopsticks.</p>
                        <p><b>Deadlock Example:</b> Every philosopher picks their left chopstick. Nobody gets a pair ‚Üí
                            all wait forever.</p>
                        <p><b>Cause:</b> Circular Wait + Hold & Wait.</p>
                        <p><b>Prevention:</b>
                            ‚Ä¢ Order the forks (left must be lower-numbered for all)
                            ‚Ä¢ Introduce a butler (permit only 4 philosophers to pick)
                        </p>
                    </div>

                    <!-- Producer Consumer -->
                    <div class="scenario-card">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Producer-consumer.svg/640px-Producer-consumer.svg.png"
                            class="scenario-img">
                        <h3>üè≠ Producer‚ÄìConsumer</h3>
                        <p><b>Scenario:</b> Producers insert items into a bounded buffer, consumers remove them.</p>
                        <p><b>Deadlock Example:</b>
                            Producer waits because buffer is full;
                            Consumer waits because buffer is empty ‚Üí circular wait.
                        </p>
                        <p><b>Cause:</b> Incorrect semaphore ordering.</p>
                        <p><b>Prevention:</b>
                            ‚Ä¢ Use semaphores (empty, full, mutex)
                            ‚Ä¢ Monitor-based synchronization
                        </p>
                    </div>

                    <!-- Readers Writers -->
                    <div class="scenario-card">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Readers-writers_problem.svg/640px-Readers-writers_problem.svg.png"
                            class="scenario-img">
                        <h3>üìö Readers‚ÄìWriters</h3>
                        <p><b>Scenario:</b> Readers can read simultaneously; writers need exclusive access.</p>
                        <p><b>Deadlock Example:</b>
                            Writer waits forever because continuous readers keep coming.
                        </p>
                        <p><b>Cause:</b> Starvation ‚Üí writer never gets the lock.</p>
                        <p><b>Prevention:</b>
                            ‚Ä¢ Writer priority locks
                            ‚Ä¢ Fair queueing / ticket-based access
                        </p>
                    </div>

                    <!-- Traffic Intersection -->
                    <div class="scenario-card">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Gridlock.jpg/640px-Gridlock.jpg"
                            class="scenario-img">
                        <h3>üöó Traffic Intersection Deadlock</h3>
                        <p><b>Scenario:</b> Four cars enter a 4-way intersection from all directions.</p>
                        <p><b>Deadlock Example:</b>
                            North car waits for East ‚Üí East waits South ‚Üí South waits West ‚Üí West waits North.
                        </p>
                        <p><b>Cause:</b> Circular wait + no preemption.</p>
                        <p><b>Prevention:</b>
                            ‚Ä¢ Traffic lights
                            ‚Ä¢ Stop signs
                            ‚Ä¢ Priority rules (Right-of-way)
                        </p>
                    </div>

                </div>
            </section>

        </main>

    </div>

    <!-- Script Loader -->
    <script src="rag.js"></script>
    <script src="banker.js"></script>
    <script src="detection.js"></script>
    <script src="scenarios.js"></script>
    <script src="app.js"></script>

    <script>
        window.onload = () => {
            initRAG();
            initBanker();
            initDetection();
            initScenarios();
        };

        function openSection(id) {
            document.querySelectorAll("section").forEach(s => s.classList.remove("active-section"));
            document.getElementById(id).classList.add("active-section");
            document.querySelectorAll(".menu-item").forEach(m => m.classList.remove("active"));
            document.querySelector(`[data-target='${id}']`).classList.add("active");
        }
    </script>

</body>

</html>